{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Logo from \"../../assets/images/PersonIcon.png\";\nimport CustomButton from \"../../components/CustomButton/CustomButton\";\nimport { useNavigation } from '@react-navigation/native';\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport { Oval } from \"react-loader-spinner\";\nimport axios from \"axios\";\nimport Audio1 from \"../../assets/images/audio1.png\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar assemblyAI = axios.create({\n  baseURL: \"https://api.assemblyai.com/v2\",\n  headers: {\n    authorization: \"6bbce7a69ff249d491a441d226023d83\",\n    \"content-type\": \"application/json\",\n    \"transfer-encoding\": \"chunked\"\n  }\n});\nvar StudentScreen = function StudentScreen() {\n  var navigation = useNavigation();\n  var handleBack = function handleBack() {\n    navigation.navigate('ChooseUser');\n  };\n  var recorder = useRef(null);\n  var audioPlayer = useRef(null);\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    blobURL = _useState2[0],\n    setBlobUrl = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    audioFile = _useState4[0],\n    setAudioFile = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isRecording = _useState6[0],\n    setIsRecording = _useState6[1];\n  useEffect(function () {\n    recorder.current = new MicRecorder({\n      bitRate: 128\n    });\n  }, []);\n  var startRecording = function startRecording() {\n    recorder.current.start().then(function () {\n      setIsRecording(true);\n    });\n  };\n  var handleImgClick = function handleImgClick() {\n    navigation.navigate('QuestionScreen');\n  };\n  var stopRecording = function stopRecording() {\n    recorder.current.stop().getMp3().then(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n        buffer = _ref2[0],\n        blob = _ref2[1];\n      var file = new File(buffer, \"audio.mp3\", {\n        type: blob.type,\n        lastModified: Date.now()\n      });\n      var newBlobUrl = URL.createObjectURL(blob);\n      setBlobUrl(newBlobUrl);\n      setIsRecording(false);\n      setAudioFile(file);\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  };\n\n  var _useState7 = useState(\"\"),\n    _useState8 = _slicedToArray(_useState7, 2),\n    uploadURL = _useState8[0],\n    setUploadURL = _useState8[1];\n  var _useState9 = useState(\"\"),\n    _useState10 = _slicedToArray(_useState9, 2),\n    transcriptID = _useState10[0],\n    setTranscriptID = _useState10[1];\n  var _useState11 = useState(\"\"),\n    _useState12 = _slicedToArray(_useState11, 2),\n    transcriptData = _useState12[0],\n    setTranscriptData = _useState12[1];\n  var _useState13 = useState(\"\"),\n    _useState14 = _slicedToArray(_useState13, 2),\n    transcript = _useState14[0],\n    setTranscript = _useState14[1];\n  var _useState15 = useState(false),\n    _useState16 = _slicedToArray(_useState15, 2),\n    isLoading = _useState16[0],\n    setIsLoading = _useState16[1];\n\n  useEffect(function () {\n    if (audioFile) {\n      assemblyAI.post(\"/upload\", audioFile).then(function (res) {\n        return setUploadURL(res.data.upload_url);\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    }\n  }, [audioFile]);\n\n  var submitTranscriptionHandler = function submitTranscriptionHandler() {\n    assemblyAI.post(\"/transcript\", {\n      audio_url: uploadURL\n    }).then(function (res) {\n      setTranscriptID(res.data.id);\n      checkStatusHandler();\n    }).catch(function (err) {\n      return console.error(err);\n    });\n  };\n\n  var checkStatusHandler = function _callee() {\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setIsLoading(true);\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(assemblyAI.get(\"/transcript/\" + transcriptID).then(function (res) {\n              setTranscriptData(res.data);\n            }));\n          case 4:\n            _context.next = 9;\n            break;\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](1);\n            console.error(_context.t0);\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 6]], Promise);\n  };\n\n  useEffect(function () {\n    var interval = setInterval(function () {\n      if (transcriptData.status !== \"completed\" && isLoading) {\n        checkStatusHandler();\n      } else {\n        setIsLoading(false);\n        setTranscript(transcriptData.text);\n        clearInterval(interval);\n      }\n    }, 1000);\n    return function () {\n      return clearInterval(interval);\n    };\n  });\n  return _jsxs(View, {\n    style: styles.root,\n    children: [_jsx(\"br\", {}), _jsx(Text, {\n      style: styles.title,\n      children: \"Child Profile\"\n    }), _jsx(\"br\", {}), _jsx(\"img\", {\n      width: \"145\",\n      height: \"135\",\n      src: Logo\n    }), _jsx(Text, {\n      style: styles.text,\n      children: \"Today's Date: 10/29\"\n    }), _jsx(\"br\", {}), _jsx(\"img\", {\n      width: \"315\",\n      height: \"280\",\n      src: Audio1,\n      onClick: handleImgClick\n    }), _jsx(CustomButton, {\n      text: \"Go Back\",\n      onPress: handleBack,\n      type: \"SECONDARY\"\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  root: {\n    alignItems: 'center',\n    padding: 20,\n    backgroundColor: '#364d59',\n    height: '100%'\n  },\n  title: {\n    fontSize: 36,\n    fontWeight: 'bold',\n    color: 'white'\n  },\n  text: {\n    marginTop: \"10px\",\n    fontSize: 20,\n    color: 'white'\n  },\n  text2: {\n    marginTop: \"10px\",\n    fontSize: 20,\n    color: 'white',\n    fontWeight: 'bold'\n  }\n});\nexport default StudentScreen;","map":{"version":3,"names":["React","useState","useEffect","useRef","Logo","CustomButton","useNavigation","MicRecorder","Oval","axios","Audio1","assemblyAI","create","baseURL","headers","authorization","StudentScreen","navigation","handleBack","navigate","recorder","audioPlayer","blobURL","setBlobUrl","audioFile","setAudioFile","isRecording","setIsRecording","current","bitRate","startRecording","start","then","handleImgClick","stopRecording","stop","getMp3","buffer","blob","file","File","type","lastModified","Date","now","newBlobUrl","URL","createObjectURL","catch","e","console","log","uploadURL","setUploadURL","transcriptID","setTranscriptID","transcriptData","setTranscriptData","transcript","setTranscript","isLoading","setIsLoading","post","res","data","upload_url","err","error","submitTranscriptionHandler","audio_url","id","checkStatusHandler","get","interval","setInterval","status","text","clearInterval","styles","root","title","StyleSheet","alignItems","padding","backgroundColor","height","fontSize","fontWeight","color","marginTop","text2"],"sources":["C:/Users/netra/Documents/GitHub/RoutineRemind/screens/StudentScreen/StudentScreen.js"],"sourcesContent":["import React, {useState, useEffect, useRef} from 'react';\r\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\r\nimport Logo from '../../assets/images/PersonIcon.png';\r\nimport CustomButton from '../../components/CustomButton/CustomButton';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport MicRecorder from \"mic-recorder-to-mp3\"\r\nimport { Oval } from \"react-loader-spinner\"\r\nimport axios from \"axios\"\r\nimport Audio1 from '../../assets/images/audio1.png';\r\n\r\nconst assemblyAI = axios.create({\r\n  baseURL: \"https://api.assemblyai.com/v2\",\r\n  headers: {\r\n    authorization: \"6bbce7a69ff249d491a441d226023d83\",\r\n    \"content-type\": \"application/json\",\r\n    \"transfer-encoding\": \"chunked\",\r\n  },\r\n})\r\n\r\nconst StudentScreen = () => {\r\n  const navigation = useNavigation()\r\n\r\n  const handleBack = () => {\r\n    navigation.navigate('ChooseUser')\r\n  }\r\n\r\n  const recorder = useRef(null) //Recorder\r\n  const audioPlayer = useRef(null) //Ref for the HTML Audio Tag\r\n  const [blobURL, setBlobUrl] = useState(null)\r\n  const [audioFile, setAudioFile] = useState(null)\r\n  const [isRecording, setIsRecording] = useState(null)\r\n\r\n  useEffect(() => {\r\n    //Declares the recorder object and stores it inside of ref\r\n    recorder.current = new MicRecorder({ bitRate: 128 })\r\n  }, [])\r\n\r\n  const startRecording = () => {\r\n    // Check if recording isn't blocked by browser\r\n    recorder.current.start().then(() => {\r\n      setIsRecording(true)\r\n    })\r\n  }\r\n\r\n  \r\n  const handleImgClick = () => {\r\n    navigation.navigate('QuestionScreen')\r\n  }\r\n\r\n  const stopRecording = () => {\r\n    recorder.current\r\n      .stop()\r\n      .getMp3()\r\n      .then(([buffer, blob]) => {\r\n        const file = new File(buffer, \"audio.mp3\", {\r\n          type: blob.type,\r\n          lastModified: Date.now(),\r\n        })\r\n        const newBlobUrl = URL.createObjectURL(blob)\r\n        setBlobUrl(newBlobUrl)\r\n        setIsRecording(false)\r\n        setAudioFile(file)\r\n      })\r\n      .catch((e) => console.log(e))\r\n  }\r\n\r\n  // AssemblyAI\r\n\r\n  // States\r\n  const [uploadURL, setUploadURL] = useState(\"\")\r\n  const [transcriptID, setTranscriptID] = useState(\"\")\r\n  const [transcriptData, setTranscriptData] = useState(\"\")\r\n  const [transcript, setTranscript] = useState(\"\")\r\n  const [isLoading, setIsLoading] = useState(false)\r\n\r\n  // Upload the Audio File and retrieve the Upload URL\r\n  useEffect(() => {\r\n    if (audioFile) {\r\n      assemblyAI\r\n        .post(\"/upload\", audioFile)\r\n        .then((res) => setUploadURL(res.data.upload_url))\r\n        .catch((err) => console.error(err))\r\n    }\r\n  }, [audioFile])\r\n\r\n  // Submit the Upload URL to AssemblyAI and retrieve the Transcript ID\r\n  const submitTranscriptionHandler = () => {\r\n    assemblyAI\r\n      .post(\"/transcript\", {\r\n        audio_url: uploadURL,\r\n      })\r\n      .then((res) => {\r\n        setTranscriptID(res.data.id)\r\n\r\n        checkStatusHandler()\r\n      })\r\n      .catch((err) => console.error(err))\r\n  }\r\n\r\n  // Check the status of the Transcript\r\n  const checkStatusHandler = async () => {\r\n    setIsLoading(true)\r\n    try {\r\n      await assemblyAI.get(`/transcript/${transcriptID}`).then((res) => {\r\n        setTranscriptData(res.data)\r\n      })\r\n    } catch (err) {\r\n      console.error(err)\r\n    }\r\n  }\r\n\r\n  // Periodically check the status of the Transcript\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      if (transcriptData.status !== \"completed\" && isLoading) {\r\n        checkStatusHandler()\r\n      } else {\r\n        setIsLoading(false)\r\n        setTranscript(transcriptData.text)\r\n\r\n        clearInterval(interval)\r\n      }\r\n    }, 1000)\r\n    return () => clearInterval(interval)\r\n  })\r\n\r\n  return (\r\n    <View style={styles.root}>\r\n      <br/>\r\n      <Text style={styles.title}>Child Profile</Text>\r\n      <br/>\r\n      <img width=\"145\" height=\"135\" src={Logo} /> \r\n      <Text style={styles.text}>Today's Date: 10/29</Text>\r\n      <br/>\r\n      <img width=\"315\" height=\"280\" src={Audio1} onClick={handleImgClick} />\r\n\r\n    <CustomButton text={\"Go Back\"} onPress={handleBack} type=\"SECONDARY\"/>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  root: {\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    backgroundColor: '#364d59',\r\n    height: '100%',\r\n  },\r\n  title: {\r\n    fontSize: 36,\r\n    fontWeight: 'bold',\r\n    color: 'white',\r\n  },\r\n  text: {\r\n    marginTop: \"10px\",\r\n    fontSize: 20,\r\n    color: 'white',\r\n  },\r\n  text2: {\r\n    marginTop: \"10px\",\r\n    fontSize: 20,\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default StudentScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module"}